<script>
	import ArticleHeader from '$lib/article-components/ArticleHeader.svelte';
	import { Heading, Hr } from 'flowbite-svelte';
	import ArticleInfo from './article-components/ArticleInfo.svelte';
	import ArticleContent from './article-components/ArticleContent.svelte';
	let articleAuthour = 'n3rd';
	let articleTtr = 12;
	let articleContent = `<div><div>\n            <p><img src="https://res.cloudinary.com/practicaldev/image/fetch/s--jVzr4EP7--/c_imagga_scale,f_auto,fl_progressive,h_420,q_auto,w_1000/https://dev-to-uploads.s3.amazonaws.com/uploads/articles/aqeah4uhn433pm0myq9c.png" alt="Cover image for Persistent Theme Switch (Dark mode) with Svelte (SvelteKit) &amp; Tailwind" />\n            </p>\n          <div>\n            <div>\n                <p><a href="https://dev.to/willkre" target="_blank"><img src="https://res.cloudinary.com/practicaldev/image/fetch/s--Zj1PFdIY--/c_fill,f_auto,fl_progressive,h_50,q_auto,w_50/https://dev-to-uploads.s3.amazonaws.com/uploads/user/profile_image/913401/1298d0ca-c86b-4053-ad2f-9561e404ede7.png" alt="Will" /></a>\n                </p>\n                <div>\n                  <p><a href="https://dev.to/willkre" target="_blank">Will</a></p><p>\n                      Posted on Aug 30, 2022\n                      ‚Ä¢ Updated on Jan 18\n                  </p>\n                </div>\n              </div>\n            <p><span>\n      <img src="https://dev.to/assets/sparkle-heart-5f9bee3767e18deb1bb725290cb151c25234768a0e9a2bd39370c382d02920cf.svg" />\n      <span> </span>\n    </span>\n    <span>\n      <img src="https://dev.to/assets/multi-unicorn-b44d6f8c23cdd00964192bedc38af3e82463978aa611b4365bd33a0f1f4f3e97.svg" />\n      <span> </span>\n    </span>\n    <span>\n      <img src="https://dev.to/assets/exploding-head-daceb38d627e6ae9b730f36a1e390fca556a4289d5a41abb2c35068ad3e2c4b5.svg" />\n      <span> </span>\n    </span>\n    <span>\n      <img src="https://dev.to/assets/raised-hands-74b2099fd66a39f2d7eed9305ee0f4553df0eb7b4f11b01b6b1b499973048fe5.svg" />\n      <span> </span>\n    </span>\n    <span>\n      <img src="https://dev.to/assets/fire-f60e7a582391810302117f987b22a8ef04a2fe0df7e3258a5f49332df1cec71e.svg" />\n      <span> </span>\n    </span>\n</p>\n          </div>\n        </div><div>\n            <p><em>Quick note - This tutorial was made with the following dependency versions: <code>"@sveltejs/kit": "next"</code> (1.1.3) &amp; <code>"tailwindcss": "^3.2.4"</code>. If something doesn‚Äôt work as it should, consider upgrading. Alternatively, if your versions are ahead, check which breaking changes have been introduced since.</em></p>\n<p>Source code can be found <a href="https://github.com/WillKre/svelte-theme-switch" target="_blank">here</a>.</p>\n<hr />\n<p><strong>Preconfiguration</strong></p>\n<p>We'll be using SvelteKit for this tutorial. If you don't have a project set up yet, you can get started <a href="https://kit.svelte.dev/docs/introduction#getting-started" target="_blank">here</a> (I recommend Skeleton + TypeScript).</p>\n<p>If you haven't configured Tailwind and added it to an <code>app.css</code> file, there are easy-to-follow instructions on the <a href="https://tailwindcss.com/docs/guides/sveltekit" target="_blank">docs</a>.</p>\n<hr />\n<p><strong>Styling and using the Switch</strong></p>\n<p>Now that everything's set up. We can start by creating the switch...</p>\n<p><em><code>src/lib/ThemeSwitch/ThemeSwitch.svelte</code></em><br />\n</p>\n<div>\n<pre><code><span>&lt;div&gt;</span>\n    <span>&lt;input</span> <span>type=</span><span>"checkbox"</span> <span>id=</span><span>"theme-toggle"</span> <span>/&gt;</span>\n    <span>&lt;label</span> <span>for=</span><span>"theme-toggle"</span> <span>/&gt;</span>\n<span>&lt;/div&gt;</span>\n<span>&lt;style </span><span>lang=</span><span>"postcss"</span><span>&gt;</span>\n    <span>#theme-toggle</span> <span>{</span>\n        <span>@apply</span> <span>invisible;</span>\n    <span>}</span>\n    <span>#theme-toggle</span> <span>+</span> <span>label</span> <span>{</span>\n        <span>@apply</span> <span>inline-block</span> <span>cursor-pointer</span> <span>h-12</span> <span>w-12</span> <span>absolute</span> <span>top-6</span> <span>right-24</span> <span>rounded-full</span> <span>duration-300</span> <span>content-[''];</span>\n    <span>}</span>\n    <span>#theme-toggle</span><span>:not</span><span>(</span><span>:checked</span><span>)</span> <span>+</span> <span>label</span> <span>{</span>\n        <span>@apply</span> <span>bg-amber-400;</span>\n    <span>}</span>\n    <span>#theme-toggle</span><span>:checked</span> <span>+</span> <span>label</span> <span>{</span>\n        <span>@apply</span> <span>bg-transparent;</span>\n        <span>box-shadow</span><span>:</span> <span>inset</span> <span>-18px</span> <span>-16px</span> <span>1px</span> <span>1px</span> <span>#ddd</span><span>;</span>\n    <span>}</span>\n<span>&lt;/style&gt;</span>\n</code></pre>\n<div>\n<p>\n    <svg width="20px" height="20px">Enter fullscreen mode\n</svg>\n    <svg width="20px" height="20px">Exit fullscreen mode\n</svg>\n</p>\n</div>\n</div>\n<p>...and using it:</p>\n<p><em><code>src/routes/+page.svelte</code></em> (or wherever else you may want to consume it, eg. <code>+layout.svelte</code>)<br />\n</p>\n<div>\n<pre><code><span>&lt;script </span><span>lang=</span><span>"ts"</span><span>&gt;</span>\n    <span>import</span> <span>ThemeSwitch</span> <span>from</span> <span>'</span><span>$lib/ThemeSwitch/ThemeSwitch.svelte</span><span>'</span><span>;</span>\n    <span>import</span> <span>'</span><span>../app.css</span><span>'</span><span>;</span>\n<span>&lt;/script&gt;</span>\n<span>&lt;ThemeSwitch</span> <span>/&gt;</span>\n<span>&lt;h1&gt;</span>Demo<span>&lt;/h1&gt;</span>\n</code></pre>\n<div>\n<p>\n    <svg width="20px" height="20px">Enter fullscreen mode\n</svg>\n    <svg width="20px" height="20px">Exit fullscreen mode\n</svg>\n</p>\n</div>\n</div>\n<p>(Note: If you get an error about referencing <code>$lib</code> like I did and are using Visual Studio Code, try <a href="https://github.com/sveltejs/language-tools/issues/1459#issuecomment-1149972032" target="_blank">restarting your editor</a>.)</p>\n<p>At this point, you should have this:</p>\n<p><a href="https://res.cloudinary.com/practicaldev/image/fetch/s--OBTxn0-A--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_66%2Cw_880/https://dev-to-uploads.s3.amazonaws.com/uploads/articles/4p86odkl74tm0ted1qr1.gif" target="_blank"><img src="https://res.cloudinary.com/practicaldev/image/fetch/s--OBTxn0-A--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_66%2Cw_880/https://dev-to-uploads.s3.amazonaws.com/uploads/articles/4p86odkl74tm0ted1qr1.gif" alt="Toggling the switch" /></a></p>\n<p><strong>Overriding Tailwind's dark mode</strong></p>\n<p>To make dark mode integration as easy as possible, Tailwind includes a dark variant that lets you style your site differently when dark mode is enabled, eg: <code>class="bg-white dark:bg-slate-800"</code>.</p>\n<p>That's cool, but we want to override the system default and toggle the dark mode manually. This means we'll need to make the following change:</p>\n<p><em><code>tailwind.config.cjs</code></em><br />\n</p>\n<div>\n<pre><code><span>module</span><span>.</span><span>exports</span> <span>=</span> <span>{</span>\n  <span>darkMode</span><span>:</span> <span>'</span><span>class</span><span>'</span><span>,</span>\n  <span>// ...</span>\n<span>}</span>\n</code></pre>\n<div>\n<p>\n    <svg width="20px" height="20px">Enter fullscreen mode\n</svg>\n    <svg width="20px" height="20px">Exit fullscreen mode\n</svg>\n</p>\n</div>\n</div>\n<p>Now, <code>dark:{class}</code> classes will be applied whenever the dark class is present earlier in the HTML tree, rather than being based on <code>prefers-color-scheme</code>.</p>\n<p>You can verify this works by adding <code>class="dark"</code> to the opening <code>html</code> tag in <code>src/app.html</code>, then adding the following:</p>\n<p><em><code>src/app.css</code></em> (You can also use a <code>global</code> style tag)<br />\n</p>\n<div>\n<pre><code><span>body</span> <span>{</span>\n  <span>@apply</span> <span>bg-white</span> <span>dark</span><span>:</span><span>bg-black</span> <span>text-black</span> <span>dark</span><span>:</span><span>text-white</span> <span>text-center</span><span>;</span>\n<span>}</span>\n</code></pre>\n<div>\n<p>\n    <svg width="20px" height="20px">Enter fullscreen mode\n</svg>\n    <svg width="20px" height="20px">Exit fullscreen mode\n</svg>\n</p>\n</div>\n</div>\n<p>This should give us this (Still a non-functional switch, but the dark mode is enabled):</p>\n<p><a href="https://res.cloudinary.com/practicaldev/image/fetch/s--NHXY83sW--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_66%2Cw_880/https://dev-to-uploads.s3.amazonaws.com/uploads/articles/df5t6n9epdmqfwcdjmkv.gif" target="_blank"><img src="https://res.cloudinary.com/practicaldev/image/fetch/s--NHXY83sW--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_66%2Cw_880/https://dev-to-uploads.s3.amazonaws.com/uploads/articles/df5t6n9epdmqfwcdjmkv.gif" alt="Toggling the switch, Dark mode enabled" /></a></p>\n<p>‚ö†Ô∏è Remember to remove the <code>class="dark"</code> from the opening <code>html</code> tag ‚ö†Ô∏è</p>\n<p><strong>Adding functionality to the Switch</strong></p>\n<p>Time to add some functionality to that currently-useless switch. We want to replicate what we did by adding/removing the <code>dark</code> class from the root of the document.</p>\n<p>We'll need to take control of the <code>checked</code> value of the <code>input</code> and action something <code>on:click</code>:<br />\n</p>\n<div>\n<pre><code><span>&lt;script </span><span>lang=</span><span>"ts"</span><span>&gt;</span>\n    <span>let</span> <span>darkMode</span> <span>=</span> <span>true</span><span>;</span>\n    <span>function</span> <span>handleSwitchDarkMode</span><span>()</span> <span>{</span>\n        <span>darkMode</span> <span>=</span> <span>!</span><span>darkMode</span><span>;</span>\n        <span>darkMode</span>\n            <span>?</span> <span>document</span><span>.</span><span>documentElement</span><span>.</span><span>classList</span><span>.</span><span>add</span><span>(</span><span>'</span><span>dark</span><span>'</span><span>)</span>\n            <span>:</span> <span>document</span><span>.</span><span>documentElement</span><span>.</span><span>classList</span><span>.</span><span>remove</span><span>(</span><span>'</span><span>dark</span><span>'</span><span>);</span>\n    <span>}</span>\n<span>&lt;/script&gt;</span>\n<span>&lt;div&gt;</span>\n    <span>&lt;input</span> <span>checked=</span><span>{darkMode}</span> <span>on:click=</span><span>{handleSwitchDarkMode}</span> <span>type=</span><span>"checkbox"</span> <span>id=</span><span>"theme-toggle"</span> <span>/&gt;</span>\n    <span>&lt;label</span> <span>for=</span><span>"theme-toggle"</span> <span>/&gt;</span>\n<span>&lt;/div&gt;</span>\n<span>&lt;!-- Styles... --&gt;</span>\n</code></pre>\n<div>\n<p>\n    <svg width="20px" height="20px">Enter fullscreen mode\n</svg>\n    <svg width="20px" height="20px">Exit fullscreen mode\n</svg>\n</p>\n</div>\n</div>\n<p>Which gives:</p>\n<p><a href="https://res.cloudinary.com/practicaldev/image/fetch/s--chR67qF6--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_66%2Cw_880/https://dev-to-uploads.s3.amazonaws.com/uploads/articles/lg819pfiazfri0132lp0.gif" target="_blank"><img src="https://res.cloudinary.com/practicaldev/image/fetch/s--chR67qF6--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_66%2Cw_880/https://dev-to-uploads.s3.amazonaws.com/uploads/articles/lg819pfiazfri0132lp0.gif" alt="Switching between dark and light mode" /></a></p>\n<p>‚ö†Ô∏è Note - If your device is not set to dark mode like mine, your default behaviour will be different to mine - this will be dealt with soon ‚ö†Ô∏è</p>\n<p><strong>Setting the default values</strong></p>\n<p>Utilising the <a href="https://developer.mozilla.org/en-US/docs/Web/API/Window/matchMedia" target="_blank">Window.mediaMatch()</a> API, we are able to update the <code>darkMode</code> value on load, dependant on what <code>prefers-color-scheme</code> the device is set to:<br />\n</p>\n<div>\n<pre><code><span>&lt;script </span><span>lang=</span><span>"ts"</span><span>&gt;</span>\n    <span>import</span> <span>{</span> <span>browser</span> <span>}</span> <span>from</span> <span>'</span><span>$app/env</span><span>'</span><span>;</span>\n    <span>let</span> <span>darkMode</span> <span>=</span> <span>true</span><span>;</span>\n    <span>function</span> <span>handleSwitchDarkMode</span><span>()</span> <span>{</span>\n        <span>darkMode</span> <span>=</span> <span>!</span><span>darkMode</span><span>;</span>\n        <span>darkMode</span>\n            <span>?</span> <span>document</span><span>.</span><span>documentElement</span><span>.</span><span>classList</span><span>.</span><span>add</span><span>(</span><span>'</span><span>dark</span><span>'</span><span>)</span>\n            <span>:</span> <span>document</span><span>.</span><span>documentElement</span><span>.</span><span>classList</span><span>.</span><span>remove</span><span>(</span><span>'</span><span>dark</span><span>'</span><span>);</span>\n    <span>}</span>\n    <span>if</span> <span>(</span><span>browser</span><span>)</span> <span>{</span>\n        <span>if</span> <span>(</span><span>window</span><span>.</span><span>matchMedia</span><span>(</span><span>'</span><span>(prefers-color-scheme: dark)</span><span>'</span><span>).</span><span>matches</span><span>)</span> <span>{</span>\n            <span>document</span><span>.</span><span>documentElement</span><span>.</span><span>classList</span><span>.</span><span>add</span><span>(</span><span>'</span><span>dark</span><span>'</span><span>);</span>\n            <span>darkMode</span> <span>=</span> <span>true</span><span>;</span>\n        <span>}</span> <span>else</span> <span>{</span>\n            <span>document</span><span>.</span><span>documentElement</span><span>.</span><span>classList</span><span>.</span><span>remove</span><span>(</span><span>'</span><span>dark</span><span>'</span><span>);</span>\n            <span>darkMode</span> <span>=</span> <span>false</span><span>;</span>\n        <span>}</span>\n    <span>}</span>\n<span>&lt;/script&gt;</span>\n<span>&lt;!-- html block... --&gt;</span>\n<span>&lt;!-- style block... --&gt;</span>\n</code></pre>\n<div>\n<p>\n    <svg width="20px" height="20px">Enter fullscreen mode\n</svg>\n    <svg width="20px" height="20px">Exit fullscreen mode\n</svg>\n</p>\n</div>\n</div>\n<p>You may have noticed the <code>if (browser)...</code>, that's just because we want to make sure that the code is only ran on the client (not server), otherwise the application would error with <code>500 - window is not defined</code>.</p>\n<p>So to recap so far:</p>\n<ul>\n<li>We have added a switch which adds and removes <code>dark</code> as a class from root of the document.</li>\n<li>Given that we've updated the <code>tailwind.config.cjs</code> to go by class, styles are being picked up in the <code>body</code> block within <code>app.css</code> and being applied to the <code>background-color</code> and text <code>color</code>.</li>\n<li>We are detecting if the user has requested dark or light mode by default with <a href="https://developer.mozilla.org/en-US/docs/Web/CSS/@media/prefers-color-scheme" target="_blank">prefers-color-scheme</a> (which is a CSS <a href="https://developer.mozilla.org/en-US/docs/Web/CSS/Media_Queries/Using_media_queries#media_features" target="_blank">media feature</a>), and we are updating the <code>darkMode</code> state (which is required by the switch) and modifying the <code>classList</code> accordingly.</li>\n</ul>\n<p>There's one more thing we need to do...</p>\n<p><strong>Enabling persistence with Local Storage</strong></p>\n<p>When we toggle the switch, we want to set the value in local storage:</p>\n<p><code>localStorage.setItem('theme', darkMode ? 'dark' : 'light');</code></p>\n<p>That will then allow us to check if the <code>theme</code> key exists, and if it does and matches the string <code>dark</code>, we know it's a positive match and can add the class and update the variable. If not, we do the opposite:<br />\n</p>\n<div>\n<pre><code><span>&lt;</span><span>script</span> <span>lang</span><span>=</span><span>"</span><span>ts</span><span>"</span><span>&gt;</span>\n    <span>import</span> <span>{</span> <span>browser</span> <span>}</span> <span>from</span> <span>'</span><span>$app/environment</span><span>'</span><span>;</span>\n    <span>let</span> <span>darkMode</span> <span>=</span> <span>true</span><span>;</span>\n    <span>function</span> <span>handleSwitchDarkMode</span><span>()</span> <span>{</span>\n        <span>darkMode</span> <span>=</span> <span>!</span><span>darkMode</span><span>;</span>\n        <span>localStorage</span><span>.</span><span>setItem</span><span>(</span><span>'</span><span>theme</span><span>'</span><span>,</span> <span>darkMode</span> <span>?</span> <span>'</span><span>dark</span><span>'</span> <span>:</span> <span>'</span><span>light</span><span>'</span><span>);</span>\n        <span>darkMode</span>\n            <span>?</span> <span>document</span><span>.</span><span>documentElement</span><span>.</span><span>classList</span><span>.</span><span>add</span><span>(</span><span>'</span><span>dark</span><span>'</span><span>)</span>\n            <span>:</span> <span>document</span><span>.</span><span>documentElement</span><span>.</span><span>classList</span><span>.</span><span>remove</span><span>(</span><span>'</span><span>dark</span><span>'</span><span>);</span>\n    <span>}</span>\n    <span>if</span> <span>(</span><span>browser</span><span>)</span> <span>{</span>\n        <span>if</span> <span>(</span>\n            <span>localStorage</span><span>.</span><span>theme</span> <span>===</span> <span>'</span><span>dark</span><span>'</span> <span>||</span>\n            <span>(</span><span>!</span><span>(</span><span>'</span><span>theme</span><span>'</span> <span>in</span> <span>localStorage</span><span>)</span> <span>&amp;&amp;</span> <span>window</span><span>.</span><span>matchMedia</span><span>(</span><span>'</span><span>(prefers-color-scheme: dark)</span><span>'</span><span>).</span><span>matches</span><span>)</span>\n        <span>)</span> <span>{</span>\n            <span>document</span><span>.</span><span>documentElement</span><span>.</span><span>classList</span><span>.</span><span>add</span><span>(</span><span>'</span><span>dark</span><span>'</span><span>);</span>\n            <span>darkMode</span> <span>=</span> <span>true</span><span>;</span>\n        <span>}</span> <span>else</span> <span>{</span>\n            <span>document</span><span>.</span><span>documentElement</span><span>.</span><span>classList</span><span>.</span><span>remove</span><span>(</span><span>'</span><span>dark</span><span>'</span><span>);</span>\n            <span>darkMode</span> <span>=</span> <span>false</span><span>;</span>\n        <span>}</span>\n    <span>}</span>\n<span>&lt;</span><span>/script</span><span>&gt;\n</span></code></pre>\n<div>\n<p>\n    <svg width="20px" height="20px">Enter fullscreen mode\n</svg>\n    <svg width="20px" height="20px">Exit fullscreen mode\n</svg>\n</p>\n</div>\n</div>\n<p>Let's add a finishing touch to the <code>body</code> so that we can get a less abrupt transition between the 2 themes: </p>\n<p><em><code>app.css</code></em><br />\n</p>\n<div>\n<pre><code><span>body</span> <span>{</span>\n    <span>transition</span><span>:</span> <span>background-color</span> <span>0.2s</span> <span>ease-in-out</span><span>,</span> <span>color</span> <span>0.2s</span> <span>ease-in-out</span><span>;</span>\n    <span>@apply</span> <span>bg-white</span> <span>dark</span><span>:</span><span>bg-black</span> <span>text-black</span> <span>dark</span><span>:</span><span>text-white</span> <span>text-center</span><span>;</span>\n<span>}</span>\n</code></pre>\n<div>\n<p>\n    <svg width="20px" height="20px">Enter fullscreen mode\n</svg>\n    <svg width="20px" height="20px">Exit fullscreen mode\n</svg>\n</p>\n</div>\n</div>\n<p>Now let's see it in action:</p>\n<p><a href="https://res.cloudinary.com/practicaldev/image/fetch/s--ZQOs9SI5--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_66%2Cw_880/https://dev-to-uploads.s3.amazonaws.com/uploads/articles/3n7ky2qhhd9vfyrrhi8r.gif" target="_blank"><img src="https://res.cloudinary.com/practicaldev/image/fetch/s--ZQOs9SI5--/c_limit%2Cf_auto%2Cfl_progressive%2Cq_66%2Cw_880/https://dev-to-uploads.s3.amazonaws.com/uploads/articles/3n7ky2qhhd9vfyrrhi8r.gif" alt="Switch with local storage persistence" /></a></p>\n<p>You can also do the initialisation in a <code>&lt;svelte:head&gt;</code> to avoid FOUC (Flash of Unstyled Content).</p>\n<p>That's it! The theme (<code>'dark' | 'light'</code>) is now persisting on refresh! ü™Ñ</p>\n<p>Source code can be found <a href="https://github.com/WillKre/svelte-theme-switch" target="_blank">here</a>.</p>\n<p>If you need any further information on the above or anything else (eg. adding new environments such as <code>staging</code>) check out the <a href="https://vitejs.dev/guide/" target="_blank">Vite docs</a>, the <a href="https://kit.svelte.dev/docs/introduction" target="_blank">SvelteKit docs</a> or the official <a href="https://svelte.div/chat" target="_blank">Svelte discord</a>.</p>\n          </div></div>`;
</script>

<div class="h-full w-full">
	<div class="article-image-container w-full h-[22rem] flex justify-center py-5">
		<div
			class="article-image w-[65%] h-full bg-[url(/img/user-placeholder.png)] bg-center bg-cover rounded-xl"
		/>
	</div>
	<ArticleHeader headingText="How to create better routes in sveltekit" />
	<ArticleInfo authour={articleAuthour} ttr={articleTtr} />
	<Hr />

	<ArticleContent content={articleContent} />
</div>
